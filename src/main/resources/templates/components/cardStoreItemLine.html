<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeleaf.org">

<div th:fragment="cardFragment(storeItem)">
  <div class="card" th:object="${storeItem}">

    <script th:inline="javascript">
      function navToItem(id) {
        window.location.href="/store/item/"+id;
      }
      async function addToCart(id, userid) {
        let counterID = id+"-counter";
        let counterEl = document.getElementById(counterID);
        let formData = new FormData();
          formData.set("id", id);
          formData.set("userId", userid);
          formData.set("count", counterEl.value);

          debugger

        const response = await fetch('/api/v1/cart/additem', {
          method: 'POST',
          body: formData
        }).then(response => {
          return response.json();
        }).then(data => {
          console.log(data);
          updateCartCounter(data);
        });
      }
    </script>

    <div class="row mt-2" >
      <div class="col-12 col-md-4" style="vertical-align: center" th:onclick="navToItem([[*{id}]])">
        <img th:src="@{*{image.fileLocation}}" class="store_line_image mr-2 align-content-center" style="float: left">
        <h6 th:text="*{name}" class=" align-content-center"></h6>
      </div>
      <div class="col-6 col-md-2 order-4">
        <div style="width: 100px" class="mr-2">
          <input th:id="*{id}+'-counter'" type="number" value="1" style="width: 55px">
          <button type="button" class="btn btn-sm btn-outline-quaternary mr-auto"
                th:onclick="addToCart([[*{id}]], [[${userId}]])">
            <i class="bi bi-cart-plus"></i>
          </button>
        </div>
        </div>
      <div class="col-12 col-md-4" style="overflow-x: clip" th:onclick="navToItem([[*{id}]])">
        <p th:text="*{description}" style="overflow: clip; max-height: 1.5em;"></p>
      </div>
      <div class="col-6 col-md-2" th:onclick="navToItem([[*{id}]])">
        <p>In Stock</p>
      </div>
    </div>

  </div>
</div>

</html>