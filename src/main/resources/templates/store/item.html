<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/defaultLayout}" xmlns="http://www.w3.org/1999/html">

<div class="container-fluid m-0 p-0" layout:fragment="content">

  <div th:replace="~{store/moduleHeader :: header}">Header</div>

  <th:block th:if="${session.msg}">
    <p th:text="${session.msg}"/>
    <th:block th:text="${#session.removeAttribute('msg')}" />
  </th:block>

  <div class="container">
    <div class="card my-2" th:object="${storeItem}">

      <div class="card-body">

        <script th:inline="javascript">
          function navToItem(id) {
            window.location.href="/store/item/"+id;
          }

        </script>

        <div class="row">
          <div class="col">
            <div style="float: right;" th:if="${#lists.contains(userRoles,'ADMIN_WRITE') or #lists.contains(userRoles,'ADMIN_READ')
                                      or #lists.contains(userRoles,'DIRECTOR_READ') or #lists.contains(userRoles,'DIRECTOR_WRITE')
                                      or #lists.contains(userRoles,'MANAGER_READ') or #lists.contains(userRoles,'MANAGER_WRITE')}">
              <button id="btnEdit" class="btn btn-sm btn-store" type="button"
                      th:onclick="window.location.href='/store/item/edit/[[*{id}]]';">Edit</button>
            </div>
            <h3 th:text="*{name}" style="float:left;"></h3>
          </div>
        </div>
        <div class="row">
          <div class="col">

            <th:block th:if="*{image}">
              <img th:src="@{*{image.fileLocation}}" class="store_image">
            </th:block>

            <span th:text="*{description}"></span>
          </div>
        </div>

        <div class="card-section">
          <div class="row">
            <div class="col-12 col-md-6 my-2">
              <div class="form-group" style="display: flex;" th:unless="*{#lists.isEmpty(itemOptions)}">
                <label class="form-control-label">Option:&nbsp;&nbsp;</label>
                <select th:id="*{id}+'-details'" class="form-control">
                  <option th:each="opt : *{itemOptions}" th:value="${opt.name}" th:text="${opt.name}"></option>
                </select>
              </div>
            </div>

            <div class="col-12 col-md-6 my-2">
              <div style="float: right">
                <input th:id="*{id}+'-counter'" type="number" value="1" th:if="*{available}" style="width: 55px">
                <input th:id="*{id}+'-counter'" type="number" value="1" th:unless="*{available}" disabled style="width: 55px">
                <button type="button" class="btn btn-sm btn-outline-store" th:if="*{available}"
                        th:onclick="addToCart([[*{id}]], [[${userId}]])"><i class="bi bi-cart-plus"></i></button>
                <button type="button" class="btn btn-sm btn-outline-store" th:unless="*{available}"
                        th:onclick="addToCart([[*{id}]], [[${userId}]])" disabled><i class="bi bi-cart-plus"></i></button>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-6">
              Lead Time: <span th:text="*{leadTime}"></span> Days
            </div>
            <div class="col-6 text-right">
              <div th:if="*{available}" style="float: right">
                <span th:if="*{specialOrder}">Special Order Item</span>
              </div>
              <div th:unless="*{available}" style="float: right">
                <span>Unavailable</span>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

</html>